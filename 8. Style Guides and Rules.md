# 8. 스타일 가이드와 규칙

- 내부 코드베이스를 관리하는 규칙
  - 소스파일을 저장하는 위치
  - 코드 포매팅
  - 명명 방식
  - 패턴
  - 예외와 스레드 사용법
- 규칙은 곧 법이다. 승인된 경우를 제외하고는 무시할 수 없다.
- 지침은 권장사항과 모범 사례를 말한다. 따르는 편이 이득이지만 규칙과 달리 변형해 적용해도 괜찮다.
- [구글 스타일 가이드](https://google.github.io/styleguide)

## 8.1 규칙이 필요한 이유

- 규칙을 관리하는 목표는 좋은 행동을 장려하고 나쁜 행동을 억제하기 위함이다.
- 좋고 나쁨의 기준은 조직별로 다르다. 메모리 사용량 저감, 런타임 성능 향상, 최신 언어 기능 사용 등. 일관성을 최우선으로 하는 조직은 기존 패턴과 다른 모든 것을 나쁘다라고 표현할 수도 있다.
- 확립된 규칙과 지침은 조직이 커지더라도 일관되게 통용되는 공통의 코딩 어휘가 되어준다.
- 어휘가 통일되면 엔지니어들은 코드를 표현하는 형식보다 코드에 담을 내용에 집중할 수 있다.

## 8.2 규칙 만들기

> 왜 이 내용이 스타일 가이드에 들어가야 하지?

- 규칙 모음을 정의할 때 던져야할 질문은 '어떤 규칙이 필요하지?'가 아니라 '어떤 목표를 이루려 하지?'
- 코딩을 규제하는 규칙 모음을 만들어서 조직이 얻는 것은 무엇일까?

### 8.2.1 기본 원칙 안내

- 구글의 규칙 모음 가치: 규모와 시간 양쪽 측면에서 탄력적인 엔지니어링 환경이 지속되도록 하는 것
- 개발 환경의 복잡도를 관리하고 엔지니어들의 생산성을 희생하지 않는 선에서 코드베이스를 관리 가능하게끔 유지하는 것
- 엔지니어의 자유를 제한하지만 표준은 일관성을 높여주고 의견 대립을 줄여주므로 혜택이 더 크다.
- 규칙을 만들 때 염두에 두어야 하는 중요한 원칙
  - 규칙의 양을 최소화한다.
  - 코드를 읽는 사람에게 맞춘다.
  - 일관되어야 한다.
  - 오류가 나기 쉽거나 예상치 못한 동작을 유발하는 구조를 피한다.
  - 꼭 필요하다면 실용성을 생각해 예외를 허용한다.

#### 규칙의 양을 최소화한다

- 조직 내 모든 엔지니어가 새로운 규칙들을 익히고 적응하는 데는 비용이 든다.
- 규칙이 너무 많다면 엔지니어들이 다 기억하지도 못할 것이고 새로 합류한 엔지니어가 적응하기도 어렵다.
- 구글은 너무 자명한 규칙은 의도적으로 배제한다.
- 한두 엔지니어만의 잘못 때문에 새로운 규칙을 만들어버리면 다른 사람들에게 정신적 부담을 주게 된다. 그러면 조직 규모를 확장할 수 없다.

#### 읽는 사람에게 맞춘다

- 코드는 작성되는 횟수보다 읽히는 횟수가 더 많으며 시간이 지날수록 차이가 벌어진다. 그러니 읽기 난해한 것보다 타이핑하기 지루한 편이 낫다.
- 구글은 엔지니어가 의도한 행위를 분명하게 알려주는 증거를 코드에 남기라고 요구한다. 코드가 하려는 일이 무엇인지를 읽는 사람이 즉시 알 수 있기를 원하는 것.
- 설계 의도를 소스 코드에 명시하지 않으면 읽는 사람이 파악해내야 해서 그 코드를 활용해야 하는 모든 이에게 추가적인 부담을 떠안긴다.
- 행위가 헷갈리거나 오해할 수 있는 상황에서는 의도한 행위를 알려주는 근거가 더욱 중요해진다.
- 함수의 구현부를 들여다보지 않고도 호출 지점에서 무슨 일이 벌어지는지를 명확히 이해할 수 있도록 한다.
- 문서화 주석은 뒤따르는 코드의 설계나 의도를 설명한다.
- 구현 주석(코드 자체에 산재하는 주석)은 뻔하지 않은 선택을 한 이유나 해명하거나 주의할 점을 알려주고, 까다로운 부분의 로직을 설명하고, 중요한 부분을 강조한다.

#### 일관되어야 한다

- 코드가 일관되게 작성되어 있다면 엔지니어들은 익숙지 않은 부분을 살펴볼 일이 생겨도 상당히 빠르게 작업을 이어갈 수 있다.
- 로컬 프로젝트라면 고유한 개성이 허용되지만, 그 프로젝트에서 사용하는 도구, 기법, 라이브러리는 모두 똑같다.

#### 일관성이 안겨주는 이점

- 일관성이 주는 이점은 우리가 잃게 되는 자유의 가치보다 훨씬 크다.
- 때로는 일관성이 구속처럼 느껴지기도 한다. 하지만 더 많은 엔지니어가 더 많은 일을 적은 노력으로 수행할 수 있게 된다.
- 모든 사람이 각자의 방식으로 코드를 작성한다면 균일성에 의존하는 도구의 이점을 제대로 누릴 수 없다. 예를 들어 누락된 임포트문을 추가하거나 쓰이지 않는 임포트문을 제거하는 도구가 있더라도 프로젝트마다 임포트문 정렬 방식이 다르다면 제대로 작동하지 않는 프로젝트가 생길 수 있다.
- 모든 사람들이 참여하는 코드를 가능한 한 일관성 있게 관리하면 엔지니어들이 새로운 팀으로 옮겨 적응하는 시간이 단축된다. 그 결과 조직의 필요에 맞게 인력을 우연하게 재배치할 수 있는 역량이 커진다.
- 시간이 흐르면서 엔지니어 일부가 프로젝트를 떠나고 새로운 인력이 합류한다. 코드 소유권이 옮겨가고 프로젝트가 합쳐지거나 나뉜다. 코드베이스가 일관되도록 노력하면 이러한 전환 비용이 낮아지고 코드와 엔지니어 모두 거의 제약 없이 재배치될 수 있다. 결국 장기적으로 봤을 때 유지보수 프로세스가 간소화된다.
