# 20. 정적 분석

- 프로그램을 실행하지 않은 채로 소스 코드를 분석하여 버그나 안티패턴 등의 잠재적인 문제를 찾아내는 것
- 분석 종류
  - 정적 분석: 프로그램을 실행하지 않고 소스 코드를 분석한다.
  - 동적 분석: 프로그램을 실행하여 소스 코드를 분석한다.
- 오버플로를 일으키는 상수 표현식, 실행되지 않는 테스트, 실행하면 비정상 종료를 일으키는 잘못된 포맷의 문자열
- 구글은 정적 분석을 이용해 모범 사례를 코드에 널리 배포하고, 최신 API를 사용하게 하며, 기술 부채를 막거나 줄여준다.

## 20.1 효과적인 정적 분석의 특징

- 새로운 분석 기법을 개발하고 특정 분석 기법을 구현하려는 연구는 수십 년 전부터 이루어져왓지만, 확장성과 유용성 측면의 연구는 상대적으로 최근에 시작되었다.

### 20.1.1 확장성

- 소프트웨어가 커지면서 분석에 걸리는 시간이 늘어나 개발 프로세스 전체가 느려지는 경향이 강해졌다. 이에따라 분석 도구들은 코드량이 많아져도 결과를 제때 내놓을 수 있도록 확장성에 집중하기 시작했다.

### 20.1.2 유용성

- 분석 유용성 측면에서는 사용자들의 비용-편익 트레이드오프(cost-benefit trade-off)를 고려해야 한다.
- 비용은 개발 시간과 코드 품질이 될 수 있다.
- 구글은 새로 추가되는 코드에서 발생하는 경고에 더 집중하고 잘 동작 중인 코드에 존재하던 이슈는 일반적으로 (보안이나 심각한 버그 등) 매주 중요할 때만 부각하고 수정한다.
- 자동을 수정할 수 있는 문제라면 뭐든 자동으로 해야 한다.

## 20.2 정적 분석을 적용하며 깨우친 핵심 교훈

- 구글이 정적 분석 도구의 효과를 극대화하기 위해 시행착오를 겪으며 얻은 교훈

1. 개발자 행복에 집중하자.
2. 정적 분석을 개발자 워크플로에 반드시 끼워 넣자.
3. 사용자가 기여할 수 있도록 하자.

### 20.2.1 개발자 행복에 집중하자

- 분석 도구가 제 역할을 얼마나 잘 수행하는지 추적한다.
  - 거짓 양성 비율(false positive rate)이 낮은 분석 도구만을 배포한다.
  - 분석 도구 사용자와 도구 개발자 사이에 피드백 루프를 구축해 사용자 신뢰를 높이고 도구도 개선되는 선순환을 구축한다.
  - 사용자 신뢰는 정적 분석 도구의 성공에 매우 중요하다.
- 거짓 음성(false negative): 분석 도구가 검출하도록 설계된 문제를 놓치는 것
- 거짓 양성(false positive): 문제가 없는데 문제를 찾았다고 보고하는 것
- 도구를 사용하고 싶은 마음을 이끌어내는 데는 거짓 음성보다 거짓 양성 비율을 낮추는 게 더 효과적이다.
- 유효 거짓 양성(effective false positive) 비율: 사용자가 거짓 양성이라고 인식하는 비율

### 20.2.2 정적 분석을 개발자 워크플로에 반드시 끼워 넣자

- 구글은 정적 분석을 코드 리뷰 도구에 통합하여 핵심 워크플로에 녹였다.

### 20.2.3 사용자가 기여할 수 있도록 하자

- 도메인 전문가들이 새로운 분석 도구를 만들거나 기존 도구에 검사 로직을 추가하는 식으로 기여할 수 있다.
