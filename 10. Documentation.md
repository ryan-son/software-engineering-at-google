# 10. 문서자료

- 대부분의 엔지니어의 불만은 양질의 문서자료가 부족하다는 것이다.
  - Side effect, 튜토리얼 중 에러, 약어 설명, 최신화 시점 등
- 테크니컬 라이터와 프로젝트 매니저가 도움을 줄 수는 있지만 현실적으로 대부분의 문서자료는 소프트웨어 엔지니어가 스스로 작성해야 한다.
- 엔지니어가 문서화를 효과적으로 할 수 있도록 도와주는 적절한 도구와 보상이 필요하다.
- 양질의 문서자료를 더 쉽게 작성하도록 하는 비결은 현재 개발 워크플로에 긴밀하게 통합되고 조직의 성장에 발맞춰 확장되는 프로세스와 도구이다.
- 2010년 후반 문서자료 실태는 상황은 1980년대 후반 소프트웨어 테스트의 상황과 유사하게 문서자료 개선에 힘써야 한다는 사실은 모두가 알지만 조직 차원에서는 문서자료가 주는 핵심 이점이 무엇인지 이해하지 못하고 있다.
- 구글은 문서자료를 코드처럼 취급하여 엔지니어링 워크플로에 통합하는 방법이 유효했다.

## 10.1 문서자료란?

- 엔지이어가 작업을 끝마치기 위해 작성해야 하는 모든 부수적인 텍스트
- 별도로 작성한 문서뿐 아니라 코드 주석까지 포함된다.

## 10.2 문서자료가 필요한 이유

- 양질의 문서자료가 있으면 코드와 API가 이해하기 더 쉬워지고 실수가 줄어든다.
- 프로젝트 팀들은 자신들의 설계 목표와 팀의 목표가 활자로 명확하게 적혀있을 때 역량을 더 집중하게 된다.
- 수동으로 해야 하는 일은 절차가 잘 기술되어 있어야 쉬워진다.
- 새로운 인력을 팀이나 코드베이스에 안착시키는 데 드는 노력이 줄어든다.
- 문서자료는 단 한 번만 작성하면 되지만 결국 수백 번, 수천 번 읽히게 된다. 초기 비용은 미래의 모든 독자에게 혜택으로 돌아간다.
  - 이 설계를 택한 이유가 뭐지?
  - 코드를 왜 이런 식으로 구현했을까?
  - 내가 왜 이렇게 구현했지?
- 이런 혜택에도 불구하고 엔지니어들이 덜 중요하게 생각하는 이유
  - 혜택이 (특히 작성자에게) 즉각적으로 돌아오지 않는다.
  - 글쓰기를 프로그래밍과 별개의 기술로 본다. (다르다 해도 글쓰기는 소프트웨어 엔지니어링에 반드시 필요한 기술이다)
  - 글쓰기에 자신 없어하는 엔지니어도 있다. (사용자 관점에서 작성하기가 중요하지 유창한 것은 상대적으로 덜 중요하다)
  - 문서자료는 도구 지원이나 개발 워크플로 통합 측면에서 아직 많이 부족하기 때문에 작성하기가 상대적으로 더 어렵다.
  - 문서자료가 기존 코드를 유지보수하기 더 쉽게 해준다고 생각하기보다는 유지보수할 대상이 하나 더 늘어난다고 생각한다.
- 조직은 어느 시점이 되면 문서화에 얼마나 많은 노력을 기울일지 결정해야 한다.
- 문서자료는 작성자에게도 다음과 같은 혜택을 준다.
  - API를 가다듬는 데 도움을 준다. API 문서는 API가 가치가 있는지를 알아내는 가장 확실한 방법 중 하나이다. 문서화를 하다 보면 자연스럽게 자신의 설계를 되돌아보게 된다. API를 말끔히 설명하거나 정의할 수 없다면 설계가 미흡했을 가능성이 크다.
  - 유지보수를 위한 로드맵과 과거 이력을 제공한다. 코딩에서 꼼수는 무조건 피해야 하지만, 어쩔 수 없다면 주석이라도 잘 달아둬야 한다. 잘만 작성해두면 2년 전 코드에서 문제점을 찾아야 하는 경우 큰 도움이 될 것이다.
  - 코드를 더 전문적이고 매력 있어 보이게 한다. 개발자들은 무의식적으로 문서화가 잘 되어 있는 API를 더 잘 설계된 API라고 여긴다. 항상 그런 것은 아니지만 일반적으로 상관성이 높다. 문서화가 잘 되어 있는 제품은 유지관리가 잘 되고 있는 제품일 확률이 높기 때문이다.
  - 이용자들의 질문이 줄어든다. 만약 다른 이에게 두 번 이상 똑같은 설명을 하고 있는 자신을 발견한다면 그 내용을 문서화하는 게 좋다.
- 읽는 이에게 최적화하라.
- 핵심 코드를 잘 문서화해두면 조직이 커질수록 지대한 기여를 한다.

## 10.3 문서자료는 코드와 같다

> 문서자료를 코드와 동일하게 변경을 추적하게 만들자.

- 문서자료도 하나의 도구이자 특정 작업을 완수하기 위해 사용하는 또 하나의 언어다.
- 구글 문서자료용 스타일 가이드(https://developers.google.com/style)
- 코드처럼 문서에도 소유자가 있다. 소유자가 없는 문서는 점점 낡아져서 유지보수하기 어려워진다. 반대로 소유권이 명확하면 문서자료 업데이트를 버그 추적 시스템과 코드 리뷰 도구 같은 기존 개발 워크플로에 통합하기 수월하다.
- 소유자가 다른 문서끼리는 내용이 상충할 수 있다. 이런 경우 표준 문서를 하나 지정하는 게 좋다. 이후 다른 관련 문서들을 통합하거나 폐기 대상으로 지정한다.
- 문서자료 취급
  - 꼭 따라야 하는 내부 정책과 규칙이 있어야 한다.
  - 버전 관리 시스템에 등록해 관리해야 한다.
  - 관리 책임자를 명시해야 한다.
  - 변경 시 문서자료가 설명하는 코드와 함께 리뷰를 거쳐야 한다.
  - 코드상의 버그를 추적하듯 문제를 추적해야 한다.
  - 주기적으로 평가(혹은 테스트)를 받아야 한다.
  - 가능하다면 정확성이나 최신 정보 반영 여부 등을 측정해야 한다.

## 10.4 독자를 알자

- 문서자료를 작성하며 저지르는 가장 큰 실수는 자신만을 위해 쓴다는 것이다.
- 자신만을 위해 쓰면 특정한 가정들이 녹아들기 쉽다. 독자는 사내의 모든 엔지니어와 외부 개발자까지 다양하므로 이를 고려해야 한다.
- 문서자료를 작성하기 전에 만족시켜야 할 독자가 누구인지를 공식적으로든 비공식적으로든 알아내야 한다.

### 10.4.1 독자 유형

- 도메인 지식을 독자의 눈높이에 맞는 기술 수준으로 써야 한다고 했지만, 그 독자란 정확히 누구인가?
  - 경험 수준: 전문 프로그래머, 혹은 프로그래밍 언어조차 낯선 초보 엔지니어
  - 도메인 지식: 팀원, 혹은 최종 API 정도에만 친숙한 사내의 다른 엔지니어
  - 목적: 여러분이 제공하는 API를 사용해 특정 작업을 수행하거나 급히 정보를 얻어내야 하는 최종 사용자, 혹은 아무에게도 유지보수를 맡기고 싶지 않을 만큼 꼬여 있는 특정 구현마저 기꺼이 책임지려 하는 소프트웨어 전문가
- 문서 작성의 핵심은 균형을 잘 잡는 것이다.
- 문서를 짧게 쓰는 것이 유리하다. 그러려면 때로는 모든 정보를 담아 길게 쓴 다음 간명하게 편집하고 중복된 정보를 삭제하는 과정을 거쳐야 한다.
- 문서자료를 접하게 되는 방식에 따른 독자 구분
  - 탐색자(seeker): 자신이 원하는 것을 정확히 알고, 읽고 있는 문서자료가 원하는 정보를 담고 있는지를 알고 싶어하는 엔지니어. 이런 독자에게는 일관성이 핵심이다. 탐색자용 문서자료를 작성한다면 비슷한 포맷을 일관되게 적용하는 것이 좋다. 그러면 독자가 빠르게 훑으며 자신이 찾는 내용이 맞는지 판단하기 편할 것이다.
  - 배회자(stumbler): 무엇을 원하는지를 정확하게 알지 못하는 사람. 아마도 맡겨진 기능을 어떻게 구현해야 할지에 대해 어슴푸레한 아이디어만 가지고 있을 것이다. 이런 독자에게는 명료한 글이 효과적이다. 가령 각 파일 맨 위에 개요나 소개 절을 두어 파일에 담겨 있는 코드의 목적을 설명한다. 어떤 독자에게 적합하지 않은 문서인지를 알려주는 것도 유용하다. 실제로 구글 문서 중 상당수는 가령 'TL;DR: 구글의 C++ 컴파일러가 궁금한 게 아니라면 더 읽을 필요 없습니다'와 같이 'TL;DR문'으로 시작한다.
- 고객(API 사용자)이냐 제공자(프로젝트 팀원)이냐도 중요한 독자 구분이다. 가능하다면 각각의 독자를 위한 문서를 구분한다. 구현과 관련한 자세한 내용은 코드를 유지보수해야 하는 팀원에게는 중요하지만 최종 사용자는 알 필요가 없는 정보다.

## 10.5 문서자료 유형

- 개발 과정에서 설계 문서, 코드 주석, How-to 문서, 프로젝트 페이지 등 다양한 문서자료를 작성하지만, 중요한 것은 종류가 다름을 알고 서로 섞이지 않게 하는 것이다.
- 하나의 API가 두 가지 일을 하면 안 되듯 하나의 문서에서 여러 가지 일을 하려 해서는 안 된다.
- 주요 문서 종류
  - 참조용 문서자료(코드 주석 포함)
  - 설계 문서
  - 튜토리얼
  - 개념 설명 문서자료
  - 랜딩 페이지
- 해당 문서에 넣기에 적절치 않아 보이는 내용이 있다면 아마도 그 목적에 더 적합한 문서가 따로 있거나, 혹은 새로 만들어야 한다는 신호다.

### 10.5.1 참조용 문서자료

- 참조용 문서자료는 코드베이스에 속한 코드의 사용법을 설명하는 문서 모두를 일컫는다.
- 코드 주석은 API 주석과 구현 주석으로 나뉜다. API 주석에는 구체적인 구현 방법이나 설계 결정사항은 언급할 필요 없다. 반면 구현 주석에서는 읽는 이가 도메인 지식을 상당히 갖추고 있다고 가정해도 된다. 팀에도 새로운 팀원이 합류할 수도 있고 작성자 본인이 다른 팀으로 떠나갈 수도 있으니 구현 주석도 체계적으로 작성해두는 편이 안전하다.

#### 파일 주석

- 구글에서는 거의 모든 코드 파일에 파일 주석이 적혀있어야 한다.
- 일반적으로 파일 주석에서는 파일에 담겨 있는 내용을 요약해줘야 한다. 해당 코드의 주요 쓰임새와 어떤 독자를 의도하고 만든 코드인지를 명시한다.
- 한두 문단으로 간결하게 설명할 수 없는 API라면 충분히 사려 깊게 설계되지 않은 API일 수 있다는 신호이다. 이런 경우라면 API를 여러 조각으로 쪼개는 방안을 고려해보는 것이 좋다.

```c++
// -----------------------------------------------------------------------------
// str_cat.h
// -----------------------------------------------------------------------------
//
// This header file contains functions for efficiently concatenating and appending
// strings: StrCat() and StrAppend(). Most of the work within these routines is
// actually handled through use of a special AlphaNum type, which was designed
// to be used as a parameter type that efficiently manages conversion to
// strings and avoids copies in the above operations.
…
```

#### 클래스 주석

- 현대적 언어들은 대부분 객체지향을 지원한다. 따라서 클래스 주석은 코드베이스에서 사용되는 API 객체들을 정의하는 중요한 주석이다.
- 구글에서는 모든 공개 클래스와 구조체는 클래스 주석을 담고 있어야 한다.
- 클래스 주석에서는 해당 클래스와 구조체의 목적과 주요 메서드들을 설명한다.
- 클래스 주석은 보통 객체임을 부각하기 위해 클래스 자신을 문장의 주어로 두고 어떻게 동작하는지를 설명하는 형태로 작성한다.
  - Foo 클래스는 x, y, z 프로퍼티를 가지며, A라는 메서드를 제공하고, 다음과 같이 B라는 측면을 지니고 있습니다.

```c++
// -----------------------------------------------------------------------------
// AlphaNum
// -----------------------------------------------------------------------------
//
// The AlphaNum class acts as the main parameter type for StrCat() and
// StrAppend(), providing efficient conversion of numeric, boolean, and
// hexadecimal values (through the Hex type) into strings.
```

#### 함수 주석

- 구글에서는 자유 함수(free function)나 클래스의 공개 메서드에는 무조건 함수가 무슨 일을 하는지를 설명하는 함수 주석이 있어야 한다.
- 함수 주석은 함수가 무슨 동작을 하고 무엇을 반환하는지를 설명하며, 능동성을 부각하기 위해 동사로 시작해야 한다.

```c++
// StrCat()
//
// Merges the given strings or numbers, using no delimiter(s),
// returning the merged result as a string.
…
```

- 함수 주석에서 'returns', 'throws'같은 다양한 상용구를 요구하는 경우도 있지만, 꼭 필요하지 않다고 판단했다. 실제로 인위적으로 섹션을 구분하지 않고 하나의 문장으로 표현하는 게 더 명확한 경우가 많다.

```c++
// Creates a new record for a customer with the given name and address,
// and returns the record ID, or throws `DuplicateEntryError` if a
// record with that name already exists.
int AddCustomer(string name, string address);
```
